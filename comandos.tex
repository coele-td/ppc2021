%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Comandos customizados
%
%   Este arquivo lista comandos customizados para utilizar no PCC.
%   Muitos comandos utilizam diretamente o arquivo Dados/unidadesCurriculares.csv
% 

% Escreve o nome por extenso da UTFPR:
\newcommand{\utf}{Universidade Tecnológica Federal do Paraná}

% Coloca um checkmark caso a disciplina seja extensionista:
\newcommand{\ifext}[2]{\ifcsvstrcmp{\ext}{0}{#1}{#2}} % Utilizado nas tabelas das unidades curriculares dos períodos

% Escreve a área da optativa
\newcommand{\optativa}[1]{
    \ifnum #1 = 21
        {Controle e automação}
    \else
        \ifnum #1 = 22
            {Trilha de Computação}
        \else
            \ifnum #1 = 23
                {Trilha de Eletrônica}
            \else
                \ifnum #1 = 24
                    {Trilha de Eletrotécnica}
                \else
                    \ifnum #1 = 31
                        {Optativas de Humanidades}
                    \else
                        \ifnum #1 = 32
                            {Optativas de Economia, Adminstração e Empreendedorismo}
                        \else    
                            \ifnum #1 = 33
                                {Optativas de Comunicação e Linguagem}
                            \else
                                \ifnum #1 = 41
                                    {Optativas de Ciências do Ambiente}
                                \else
                                    !Erro!
                                \fi
                            \fi
                        \fi
                    \fi
                \fi
            \fi
        \fi
    \fi

}

% Escreve o período por extenso
\newcommand{\pernum}[1]{% \pernum{<número do período de 1 à 10>}
    \ifnum #1 = 1
        Primeiro
    \else
        \ifnum #1 = 2
            Segundo
        \else
            \ifnum #1 = 3
                Terceiro
            \else
                \ifnum #1 = 4
                    Quarto
                \else
                    \ifnum #1 = 5
                        Quinto
                    \else
                        \ifnum #1 = 6
                            Sexto
                        \else
                            \ifnum #1 = 7
                                Sétimo
                            \else
                                \ifnum #1 = 8
                                    Oitavo
                                \else
                                    \ifnum #1 = 9
                                        Nono
                                    \else
                                        \ifnum #1 = 10
                                            Décimo
                                        \else
                                            !Erro!
                                        \fi
                                    \fi
                                \fi
                            \fi
                        \fi
                    \fi
                \fi
            \fi
        \fi
    \fi
}

% Imprime a planilha do período
\newcommand{\tabelaPeriodo}[2]{% \tabelaPeriodo{<número do período de 1 à 10>}{<arquivo csv>}
    
    \begin{tabularx}{\textwidth}{>{\centering\arraybackslash}X >{\centering\arraybackslash}X c||cccc}\toprule

        % Primeira linha:
    	\multicolumn{3}{c||}{\bfseries \pernum{#1} Período}	&	\multicolumn{4}{c}{\bfseries Carga horária (h)}\\
    	\midrule

        % Variáveis da tabela em negrito:
    	\bfseries Unidade Curricular & \bfseries Área do Conhecimento	& \bfseries Extensionista & \bfseries AT$^1$ & \bfseries AP$^2$& \bfseries ANP$^3$ & \bfseries Total\\
    	\midrule
    
        \csvreader[ head to column names,
                    separator=pipe,
                    %before first line=\\\rowcolor{gray!10},                 
                    late after line=\csvifoddrow{\\}{\\\rowcolor{gray!10}}, 
                    filter test=\ifnumequal{\periodo}{#1}]%
                    {#2}{}%
    	{\hyperref[qua:uc\codigo]{\nome}	& \areaConhecimento	& \ifext{-}{\checkmark} & \chTeorica	& \chPratica	& \anp	& \chtotal }%

    	\midrule

        \rowcolor{white}\multicolumn{3}{r}{\bfseries Totais:} & \bfseries \the\value{horasAT#1} & \bfseries \the\value{horasAP#1} & \bfseries \the\value{horasANP#1} & \bfseries \the\value{horasT#1}\\
        
        % \midrule
        
        % \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária presencial total:} & \bfseries \the\value{horasP#1}\\
        % \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária não-presencial total:} & \bfseries \the\value{horasANP#1}\\
    	% \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária total:} & \bfseries \the\value{horasP#1}\\

    	\bottomrule  

    	\multicolumn{7}{l}{$^1$ \tiny AT - Atividades Teóricas}\\
    	\multicolumn{7}{l}{$^2$ \tiny AP - Atividades Práticas}\\
    	\multicolumn{7}{l}{$^3$ \tiny ANP - Atividades não-presenciais}\\	
    \end{tabularx}    
}	

% Imprime a planilha de trilha ou Optativa
\newcommand{\tabelaTrilha}[2]{% \tabelaTrilha{<número da Optativa de 21 à 49>}{<arquivo csv>}
    
    \begin{tabularx}{\textwidth}{>{\centering\arraybackslash}X >{\centering\arraybackslash}X c||cccc}\toprule

        % Primeira linha:
    	\multicolumn{3}{c||}{\bfseries \optativa{#1}}	&	\multicolumn{4}{c}{\bfseries Carga horária (h)}\\
    	\midrule

        % Variáveis da tabela em negrito:
    	\bfseries Unidade Curricular & \bfseries Área do Conhecimento	& \bfseries Extensionista & \bfseries AT$^1$ & \bfseries AP$^2$& \bfseries ANP$^3$ & \bfseries Total\\
    	\midrule
    
        \csvreader[ head to column names,
                    separator=pipe,
                    %before first line=\\\rowcolor{gray!10},                 
                    late after line=\csvifoddrow{\\}{\\\rowcolor{gray!10}}, 
                    filter test=\ifnumequal{\periodo}{#1}]%
                    {#2}{}%
    	{\hyperref[qua:uc\codigo]{\nome}	& \areaConhecimento	& \ifext{-}{\checkmark} & \chTeorica	& \chPratica	& \anp	& \chtotal }%

    	\midrule

        \rowcolor{white}\multicolumn{3}{r}{\bfseries Totais:} & \bfseries \the\value{horasAT#1} & \bfseries \the\value{horasAP#1} & \bfseries \the\value{horasANP#1} & \bfseries \the\value{horasT#1}\\
        
        % \midrule
        
        % \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária presencial total:} & \bfseries \the\value{horasP#1}\\
        % \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária não-presencial total:} & \bfseries \the\value{horasANP#1}\\
    	% \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária total:} & \bfseries \the\value{horasP#1}\\

    	\bottomrule  

    	\multicolumn{7}{l}{$^1$ \tiny AT - Atividades Teóricas}\\
    	\multicolumn{7}{l}{$^2$ \tiny AP - Atividades Práticas}\\
    	\multicolumn{7}{l}{$^3$ \tiny ANP - Atividades não-presenciais}\\	
    \end{tabularx}  
}  

% Imprime a planilha Optativas de humanas
\newcommand{\tabelaOptHum}[2]{% \tabelaTrilha{<número da Optativa de 21 à 49>}{<arquivo csv>}
    
    \begin{tabularx}{\textwidth}{>{\centering\arraybackslash}X >{\centering\arraybackslash}X c||cccc}\toprule

        % Primeira linha:
    	\multicolumn{3}{c||}{\bfseries \optativa{#1}}	&	\multicolumn{4}{c}{\bfseries Carga horária (h)}\\
    	\midrule

        % Variáveis da tabela em negrito:
    	\bfseries Unidade Curricular & \bfseries Área & \bfseries Extensionista & \bfseries AT$^1$ & \bfseries AP$^2$& \bfseries ANP$^3$ & \bfseries Total\\
    	\midrule
    
        \csvreader[ head to column names,
                    separator=pipe,
                    %before first line=\\\rowcolor{gray!10},                 
                    late after line=\csvifoddrow{\\}{\\\rowcolor{gray!10}}, 
                    filter test=\ifnumequal{\periodo}{#1}]%
                    {#2}{}%
    	{\hyperref[qua:uc\codigo]{\nome}	& \areaHumanas	& \ifext{-}{\checkmark} & \chTeorica	& \chPratica	& \anp	& \chtotal }%

    	\midrule

        \rowcolor{white}\multicolumn{3}{r}{\bfseries Totais:} & \bfseries \the\value{horasAT#1} & \bfseries \the\value{horasAP#1} & \bfseries \the\value{horasANP#1} & \bfseries \the\value{horasT#1}\\
        
        % \midrule
        
        % \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária presencial total:} & \bfseries \the\value{horasP#1}\\
        % \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária não-presencial total:} & \bfseries \the\value{horasANP#1}\\
    	% \rowcolor{white}\multicolumn{6}{r}{\bfseries Carga horária total:} & \bfseries \the\value{horasP#1}\\

    	\bottomrule  

    	\multicolumn{7}{l}{$^1$ \tiny AT - Atividades Teóricas}\\
    	\multicolumn{7}{l}{$^2$ \tiny AP - Atividades Práticas}\\
    	\multicolumn{7}{l}{$^3$ \tiny ANP - Atividades não-presenciais}\\	
    \end{tabularx}  
}  


% Imprime as ementas de um período
\newcommand{\imprimeEmentas}[2]{% % \imprimeEmentas{<número do período de 1 à 10>}{<arquivo csv>}
    \csvreader[head to column names, separator=pipe, filter test=\ifnumequal{\periodo}{#1}]{#2}{}{%
	
		\begin{quadro}[!ht]
            \footnotesize
			\centering
			\caption{Dados estruturais da unidade curricular de \nome}
			\label{qua:uc\codigo}
			\begin{tabularx}{\textwidth}{|c|>{\centering}m{4cm}|c|c|}
            %\begin{tabularx}{\textwidth}{|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|}
				\hline
				\multicolumn{4}{|>{\centering}X|}{\cellcolor[HTML]{656565}\bfseries \color{white} \vspace{5pt} \nome \vspace{5pt}}\\ \hline\hline				
				\cellcolor[HTML]{C0C0C0}Período                 & \hyperref[tab:per\periodo]{\pernum{\periodo}}			    & \cellcolor[HTML]{C0C0C0}Código			& \codigo		    \\ \hline
				\cellcolor[HTML]{C0C0C0}Referência na matriz    & \referencia		                                        & \cellcolor[HTML]{C0C0C0}Pré-requisito		& \prereq		    \\ \hline
				\cellcolor[HTML]{C0C0C0}Área do Conhecimento    & \areaConhecimento	                                        & \cellcolor[HTML]{C0C0C0}Modalidade 		& \modalidade	    \\ \hline				
				\cellcolor[HTML]{C0C0C0}Extensionista 			& \ifext{não}{sim}                                          & \cellcolor[HTML]{C0C0C0}Idioma        	& \idioma           \\ \hline\hline
				\multirow{3}{*}{\bfseries Carga Horária}        & \multicolumn{2}{c|}{\bfseries Atividade Teórica - AT}                                                  & \chTeorica{} h    \\ \cline{2-4}
				                                                & \multicolumn{2}{c|}{\bfseries Atividade Prática - AP}                                                  & \chPratica{} h    \\ \cline{2-4}
				                                                & \multicolumn{2}{c|}{\bfseries Não Presencial - ANP}                                                    & \anp{} h          \\ \hline

				\multicolumn{4}{|c|}{\cellcolor[HTML]{C0C0C0}\textbf{Carga horária total: \chtotal{} h}}  																		            \\ \hline\hline
				\multicolumn{4}{|>{\centering}X|}{\bfseries \vspace{5pt} Ementa \vspace{5pt}}                                                                       			            \\ \hline
				\multicolumn{4}{|>{\hsize=\hsize}X|}{\ementa}                                                                                                                               \\ \hline
			\end{tabularx}
			\fonte{Autoria própria}
		\end{quadro}
	
	}
}

% Imprime as ementas de optativas
\newcommand{\imprimeEmentasOpt}[2]{% % \imprimeEmentas{<número do período de 21 à 49>}{<arquivo csv>}
    \csvreader[head to column names, separator=pipe, filter test=\ifnumequal{\periodo}{#1}]{#2}{}{%
	
		\begin{quadro}[!ht]
            \footnotesize
			\centering
			\caption{Dados estruturais da unidade curricular optativa de \nome}
			\label{qua:uc\codigo}
			\begin{tabularx}{\textwidth}{|c|>{\centering}m{4cm}|c|c|}
            %\begin{tabularx}{\textwidth}{|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|}
				\hline
				\multicolumn{4}{|>{\centering}X|}{\cellcolor[HTML]{656565}\bfseries \color{white} \vspace{5pt} \nome \vspace{5pt}}\\ \hline\hline				
				\cellcolor[HTML]{C0C0C0}Tipo de Optativa        & \optativa{\periodo}			        & \cellcolor[HTML]{C0C0C0}Código			& \codigo		    \\ \hline
				\cellcolor[HTML]{C0C0C0}Referência na matriz    & \referencia		                                        & \cellcolor[HTML]{C0C0C0}Pré-requisito		& \prereq		    \\ \hline
				\cellcolor[HTML]{C0C0C0}Área do Conhecimento    & \areaConhecimento	                                        & \cellcolor[HTML]{C0C0C0}Modalidade 		& \modalidade	    \\ \hline				
				\cellcolor[HTML]{C0C0C0}Extensionista 			& \ifext{não}{sim}                                          & \cellcolor[HTML]{C0C0C0}Idioma        	& \idioma           \\ \hline\hline
				\multirow{3}{*}{\bfseries Carga Horária}        & \multicolumn{2}{c|}{\bfseries Atividade Teórica - AT}                                                  & \chTeorica{} h    \\ \cline{2-4}
				                                                & \multicolumn{2}{c|}{\bfseries Atividade Prática - AP}                                                  & \chPratica{} h    \\ \cline{2-4}
				                                                & \multicolumn{2}{c|}{\bfseries Não Presencial - ANP}                                                    & \anp{} h          \\ \hline

				\multicolumn{4}{|c|}{\cellcolor[HTML]{C0C0C0}\textbf{Carga horária total: \chtotal{} h}}  																		            \\ \hline\hline
				\multicolumn{4}{|>{\centering}X|}{\bfseries \vspace{5pt} Ementa \vspace{5pt}}                                                                       			            \\ \hline
				\multicolumn{4}{|>{\hsize=\hsize}X|}{\ementa}                                                                                                                               \\ \hline
			\end{tabularx}
			\fonte{Autoria própria}
		\end{quadro}
	
	}
}

% Imprime as ementas de optativas de Humanidades
\newcommand{\imprimeEmentasHum}[2]{% % \imprimeEmentas{<número do período de 21 à 49>}{<arquivo csv>}
    \csvreader[head to column names, separator=pipe, filter test=\ifnumequal{\periodo}{#1}]{#2}{}{%
	
		\begin{quadro}[!ht]
            \footnotesize
			\centering
			\caption{Dados estruturais da unidade curricular optativa de \nome}
			\label{qua:uc\codigo}
			\begin{tabularx}{\textwidth}{|c|>{\centering}m{4cm}|c|c|}
            %\begin{tabularx}{\textwidth}{|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|}
				\hline
				\multicolumn{4}{|>{\centering}X|}{\cellcolor[HTML]{656565}\bfseries \color{white} \vspace{5pt} \nome \vspace{5pt}}\\ \hline\hline				
				\cellcolor[HTML]{C0C0C0}Tipo de Optativa        & \optativa{\periodo}			        & \cellcolor[HTML]{C0C0C0}Código			& \codigo		    \\ \hline
				\cellcolor[HTML]{C0C0C0}Referência na matriz    & \referencia		                                        & \cellcolor[HTML]{C0C0C0}Pré-requisito		& \prereq		    \\ \hline
				\cellcolor[HTML]{C0C0C0}Área do Conhecimento    & \areaHumanas	                                            & \cellcolor[HTML]{C0C0C0}Modalidade 		& \modalidade	    \\ \hline				
				\cellcolor[HTML]{C0C0C0}Extensionista 			& \ifext{não}{sim}                                          & \cellcolor[HTML]{C0C0C0}Idioma        	& \idioma           \\ \hline\hline
				\multirow{3}{*}{\bfseries Carga Horária}        & \multicolumn{2}{c|}{\bfseries Atividade Teórica - AT}                                                  & \chTeorica{} h    \\ \cline{2-4}
				                                                & \multicolumn{2}{c|}{\bfseries Atividade Prática - AP}                                                  & \chPratica{} h    \\ \cline{2-4}
				                                                & \multicolumn{2}{c|}{\bfseries Não Presencial - ANP}                                                    & \anp{} h          \\ \hline

				\multicolumn{4}{|c|}{\cellcolor[HTML]{C0C0C0}\textbf{Carga horária total: \chtotal{} h}}  																		            \\ \hline\hline
				\multicolumn{4}{|>{\centering}X|}{\bfseries \vspace{5pt} Ementa \vspace{5pt}}                                                                       			            \\ \hline
				\multicolumn{4}{|>{\hsize=\hsize}X|}{\ementa}                                                                                                                               \\ \hline
			\end{tabularx}
			\fonte{Autoria própria}
		\end{quadro}
	
	}
}

%Lista as disciplinas de um período em texto corrido, referenciando o quadro das características estruturais
\newcommand{\tiraespaco}{)}
\newcommand{\listaUC}[2]{\!\!\!
    \csvreader[ head to column names, 
                separator=pipe,                
                late after line={{,}\space},
                late after first line={{,}\space},
                late after last line={},
                filter test=\ifnumequal{\periodo}{#1}]{#2}{}{%
        \nome\space(\autoref{qua:uc\codigo}\tiraespaco
    }\!\!
}

%\newcommand{\tiraespaco}{)}
% \newcommand{\listaUC}[2]{
    
%     \csvreader[ head to column names,
%                 before first line=\autoref{qua:uc\codigo},
%                 after line=\space{à} \autoref{qua:uc\codigo},
%                 separator=pipe, 
%                 filter test=\ifnumequal{\periodo}{#1}]{#2}{}{}
    
% }

%Retorna a percentagem dos segundo argumento (#2) em relação ao terceiro (#3), o primeiro parâmetro (#1) é opcional e representa as casas decimais (padrão = 2)
\newcommand{\percentagem}[3][2]{\FPset\tempval{0}\FPeval{\tempval}{round(100*#2/#3,#1)}$\tempval$\%}


